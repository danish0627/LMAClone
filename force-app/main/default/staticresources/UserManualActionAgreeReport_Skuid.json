[{"attributes":{"type":"skuid__Page__c","url":"/services/data/v42.0/sobjects/skuid__Page__c/a1x1F0000005dFJQAY"},"Id":"a1x1F0000005dFJQAY","Name":"UserManualActionAgreeReport","skuid__Type__c":"Desktop","skuid__UniqueId__c":"Manuals_UserManualActionAgreeReport","skuid__Module__c":"Manuals","skuid__Composer_Settings__c":null,"skuid__MasterPage__c":null,"skuid__MasterPage__r":null,"skuid__IsMaster__c":false,"skuid__Layout__c":"<skuidpage unsavedchangeswarning=\"yes\" personalizationmode=\"server\" showsidebar=\"true\" useviewportmeta=\"true\" showheader=\"true\" theme=\"Lightning Design\"><models><model id=\"EventEdition\" limit=\"20\" query=\"true\" createrowifnonefound=\"false\" datasource=\"salesforce\" sobject=\"Event_Edition__c\"><fields><field id=\"Id\"/><field id=\"Name\"/><field id=\"Company_Name__c\"/></fields><conditions><condition type=\"param\" value=\"id\" field=\"Id\" operator=\"=\" novaluebehavior=\"\" enclosevalueinquotes=\"true\"/></conditions><actions/></model><model id=\"ManualPermission\" limit=\"20\" query=\"true\" createrowifnonefound=\"false\" datasource=\"salesforce\" sobject=\"Manuals_Permission__c\"><fields><field id=\"Manuals__c\"/><field id=\"Manuals__r.Name\"/><field id=\"Name\"/><field id=\"Id\"/><field id=\"Manuals__r.Event_Edition__c\"/><field id=\"Manuals__r.Event_Edition__r.Name\"/></fields><conditions><condition type=\"param\" value=\"mpId\" field=\"Manuals__c\" operator=\"=\" enclosevalueinquotes=\"true\" novaluebehavior=\"\"/></conditions><actions/></model><model id=\"UserActionManualAgree\" limit=\"400\" query=\"true\" createrowifnonefound=\"false\" datasource=\"salesforce\" sobject=\"User_Manual_Action__c\"><fields><field id=\"Manual_Permission__r.Manuals__r.Name\"/><field id=\"User_Manual_Contact__r.Type__c\"/><field id=\"User_Manual_Contact__r.Type__r.Name\"/><field id=\"User__c\"/><field id=\"User__r.Name\"/><field id=\"Manual_Permission__c\"/><field id=\"Manual_Permission__r.Name\"/><field id=\"Manual_Permission__r.Manuals__c\"/><field id=\"User__r.ContactId\"/><field id=\"User__r.Contact.Name\"/><field id=\"User__r.Contact.Type__c\"/><field id=\"User__r.Contact.Type__r.Name\"/><field id=\"Id\"/><field id=\"Is_Agree__c\"/><field id=\"User_Manual_Contact__r.Account.Name\"/><field id=\"User_Manual_Contact__c\"/><field id=\"User_Manual_Contact__r.Name\"/><field id=\"Account__c\"/><field id=\"Account__r.Name\"/><field id=\"User_Type__c\"/><field id=\"User_Type__r.Name\"/><field id=\"User_Manual_Contact__r.Email\"/><field id=\"Is_Viewed__c\"/></fields><conditions><condition type=\"modelmerge\" value=\"\" field=\"Manual_Permission__c\" operator=\"in\" model=\"ManualPermission\" enclosevalueinquotes=\"true\" mergefield=\"Id\" novaluebehavior=\"deactivate\"/><condition type=\"fieldvalue\" value=\"true\" enclosevalueinquotes=\"false\" field=\"Is_Agree__c\" operator=\"=\"/><condition type=\"multiple\" field=\"User_Type__c\" operator=\"in\" inactive=\"true\" enclosevalueinquotes=\"true\" name=\"__autofilter__User_Type__c\" state=\"filterableoff\" value=\"\"/><condition type=\"fieldvalue\" value=\"true\" enclosevalueinquotes=\"false\" field=\"Manual_Permission__r.Active__c\"/></conditions><actions/></model><model id=\"UserActionManualNotAgree\" limit=\"400\" query=\"true\" createrowifnonefound=\"false\" datasource=\"salesforce\" sobject=\"User_Manual_Action__c\"><fields><field id=\"Manual_Permission__r.Manuals__r.Name\"/><field id=\"User__r.Name\"/><field id=\"User_Manual_Contact__r.Type__r.Name\"/><field id=\"User__c\"/><field id=\"User_Manual_Contact__c\"/><field id=\"User_Manual_Contact__r.Name\"/><field id=\"Name\"/><field id=\"Manual_Permission__c\"/><field id=\"Manual_Permission__r.Name\"/><field id=\"Manual_Permission__r.Manuals__c\"/><field id=\"User_Manual_Contact__r.Type__c\"/><field id=\"Id\"/><field id=\"Is_Agree__c\"/><field id=\"Is_Agree_Image__c\"/><field id=\"User_Manual_Contact__r.Account.Name\"/><field id=\"User_Manual_Contact__r.Id\"/><field id=\"Account__c\"/><field id=\"Account__r.Name\"/><field id=\"User_Type__c\"/><field id=\"User_Type__r.Name\"/><field id=\"User_Manual_Contact__r.Email\"/><field id=\"Is_Viewed__c\"/></fields><conditions><condition type=\"modelmerge\" value=\"\" field=\"Manual_Permission__c\" operator=\"in\" model=\"ManualPermission\" enclosevalueinquotes=\"true\" mergefield=\"Id\" novaluebehavior=\"deactivate\"/><condition type=\"fieldvalue\" value=\"false\" enclosevalueinquotes=\"false\" field=\"Is_Agree__c\"/><condition type=\"multiple\" field=\"User_Type__c\" operator=\"in\" inactive=\"true\" enclosevalueinquotes=\"true\" name=\"__autofilter__User_Type__c\" state=\"filterableoff\" value=\"\"/><condition type=\"fieldvalue\" value=\"true\" enclosevalueinquotes=\"false\" field=\"Manual_Permission__r.Active__c\"/></conditions><actions/></model></models><components><wrapper uniqueid=\"sk-2ddcyj-427\"><components><pagetitle uniqueid=\"sk-2-OWEF-201\" model=\"ManualPermission\"><maintitle>{{Manuals__c}}</maintitle><actions><action type=\"multi\" label=\"Close \" uniqueid=\"sk-2sbcIA-200\"><actions><action type=\"redirect\" window=\"self\" url=\"/apex/skuid__ui?page=Manual_List&amp;id={{{Manuals__r.Event_Edition__c}}}\"/></actions></action></actions></pagetitle><tabset rememberlastusertab=\"true\" defertabrendering=\"true\" uniqueid=\"sk-2abMAr-869\" renderas=\"\"><tabs><tab name=\"{{$Label.Agreed}}\"><components><skootable showconditions=\"true\" showsavecancel=\"false\" showerrorsinline=\"true\" searchmethod=\"server\" searchbox=\"true\" showexportbuttons=\"false\" pagesize=\"10\" createrecords=\"false\" model=\"UserActionManualAgree\" buttonposition=\"\" mode=\"readonly\" allowcolumnreordering=\"true\" uniqueid=\"sk-2dsiap-413\"><fields><field id=\"Account__r.Name\" hideable=\"true\" uniqueid=\"fi-2jxq1z-321\" valuehalign=\"\" type=\"\"><label>{{$Label.Account}}</label></field><field id=\"User_Type__r.Name\" hideable=\"true\" uniqueid=\"fi-2j_-Yw-290\" valuehalign=\"\" type=\"\"><label>{{$Label.User_Type}}</label></field></fields><rowactions/><massactions usefirstitemasdefault=\"true\"/><views><view type=\"standard\"/></views><filters><filter type=\"multiselect\" filteroffoptionlabel=\"{{$Label.User}} {{$Label.Type}}\" createfilteroffoption=\"true\" affectcookies=\"true\" autocompthreshold=\"25\" conditionsource=\"auto\" labelmode=\"manual\" conditionfield=\"User_Type__c\" conditionoperator=\"in\" label=\"{{$Label.User}} {{$Label.Type}}\" fieldtargetobjects=\"User_Type__c\"/></filters><actions defaultlabel=\"Global Actions\" defaulticon=\"sk-icon-magic\" usefirstitemasdefault=\"true\"><action type=\"multi\" label=\"{{$Label.Export_Marketing_list}}\" icon=\"sk-icon-export\"><actions><action type=\"requeryModel\" model=\"UserActionManualAgree\" behavior=\"standard\"/><action type=\"custom\" snippet=\"UserActionManualAgreeSnippet\"/></actions></action></actions></skootable></components></tab><tab name=\" {{$Label.Not}} {{$Label.Agreed}}\" loadlazypanels=\"true\"><components><pagetitle model=\"ManualPermission\" uniqueid=\"sk-2dzdAe-319\"><actions><action type=\"multi\" label=\"{{$Label.Send_Email_for_this_manual}}\" uniqueid=\"sk-1QN2ue-97\"><actions><action type=\"blockUI\" message=\"Sending Single Reminder Email\" timeout=\"1500\"/><action type=\"custom\" snippet=\"SingleManualReminderEmail\"><onerroractions><action type=\"blockUI\" message=\"There was an error\" timeout=\"3000\"/></onerroractions></action></actions></action></actions><renderconditions logictype=\"and\"/></pagetitle><skootable showconditions=\"true\" showsavecancel=\"false\" showerrorsinline=\"true\" searchmethod=\"server\" searchbox=\"true\" showexportbuttons=\"false\" pagesize=\"10\" createrecords=\"false\" model=\"UserActionManualNotAgree\" buttonposition=\"\" mode=\"readonly\" allowcolumnreordering=\"true\" uniqueid=\"sk-2dt9vb-519\"><fields><field id=\"Account__r.Name\" hideable=\"true\" uniqueid=\"fi-2jxuGi-366\"><label>{{$Label.Account}}</label></field><field id=\"User_Type__r.Name\" hideable=\"true\" uniqueid=\"fi-2j-3kV-339\"><label>{{$Label.User_Type}}</label></field></fields><rowactions/><massactions usefirstitemasdefault=\"true\"/><views><view type=\"standard\"/></views><searchfields/><actions defaultlabel=\"Global Actions\" defaulticon=\"sk-icon-magic\" usefirstitemasdefault=\"true\"><action type=\"multi\" label=\"{{$Label.Export_Marketing_list}}\" icon=\"sk-icon-export\"><actions><action type=\"requeryModel\" model=\"UserActionManualNotAgree\" behavior=\"standard\"/><action type=\"custom\" snippet=\"UserActionManualNotAgreeSnippet\"/></actions></action></actions><filters><filter type=\"multiselect\" filteroffoptionlabel=\"{{$Label.User}} {{$Label.Type}}\" createfilteroffoption=\"true\" affectcookies=\"true\" autocompthreshold=\"25\" conditionsource=\"auto\" labelmode=\"manual\" conditionfield=\"User_Type__c\" conditionoperator=\"in\" label=\"{{$Label.User}} {{$Label.Type}}\" fieldtargetobjects=\"User_Type__c\"/></filters></skootable></components></tab></tabs></tabset></components><styles><styleitem type=\"background\"/><styleitem type=\"border\" padding=\"bottom,right,top,left,\"><styles><styleitem property=\"padding-left\" value=\"25px\"/><styleitem property=\"padding-top\" value=\"5px\"/><styleitem property=\"padding-right\" value=\"5px\"/><styleitem property=\"padding-bottom\" value=\"0px\"/><styleitem property=\"box-sizing\" value=\"border-box\"/></styles></styleitem><styleitem type=\"size\"/></styles></wrapper></components><resources><labels><label id=\"Agreed\"/><label id=\"Not\"/><label id=\"Send\"/><label id=\"Email\"/><label id=\"User\"/><label id=\"Type\"/><label id=\"Send_Email_for_this_manual\"/><label id=\"Account\"/><label id=\"User_Type\"/><label id=\"Export\"/><label id=\"Export_Marketing_list\"/></labels><javascript><jsitem location=\"inlinesnippet\" name=\"UserActionManualAgreeSnippet\" cachelocation=\"false\">/*\n    ** Snippet to export all the userlist who has agreed the Manuals\n*/\nvar model = skuid.model.getModel('UserActionManualAgree');\nvar row= model.getFirstRow();\nmodel.exportData({\n    fileName: 'Manual- '+row.Manual_Permission__r.Manuals__r.Name+'.csv',\n     doNotAppendRowIdColumn: true,\n    fields: \n    [\n        model.getField('Manual_Permission__r.Manuals__r.Name'),\n        model.getField('Account__r.Name'),\n        model.getField('Is_Viewed__c'),\n        model.getField('Is_Agree__c'),\n        model.getField('User_Type__r.Name'),\n        model.getField('User_Manual_Contact__r.Email')\n    ]\n});</jsitem><jsitem location=\"inlinesnippet\" name=\"UserActionManualNotAgreeSnippet\" cachelocation=\"false\">/*\n    ** Snippet to export all the userlist who hasn't agreed the Manuals\n*/\nvar model = skuid.model.getModel('UserActionManualNotAgree');\nvar row= model.getFirstRow();\nmodel.exportData({\n    fileName: 'Manual- '+row.Manual_Permission__r.Manuals__r.Name+'.csv',\n     doNotAppendRowIdColumn: true,\n    fields: \n    [\n        model.getField('Manual_Permission__r.Manuals__r.Name'),\n        model.getField('Account__r.Name'),\n        model.getField('Is_Viewed__c'),\n        model.getField('Is_Agree__c'),\n        model.getField('User_Type__r.Name'),\n        model.getField('User_Manual_Contact__r.Email')\n    ]\n});</jsitem><jsitem location=\"inlinesnippet\" name=\"SingleManualReminderEmail\" cachelocation=\"false\">/*\n    ** Snippet to send the single email reminder to all the user who has't viewed and aggred the particular manual\n*/\nvar params = arguments[0],\n\t$ = skuid.$;\n\n   var modelE = skuid.model.getModel('EventEdition');\n   console.log(modelE);\n    var rowE = modelE.getFirstRow();\n    console.log(rowE);\n    var eID= rowE.Id;\n    console.log(eID);\n    \n    var modelEM = skuid.model.getModel('ManualPermission');\n    var rowEM = modelEM.getFirstRow();\n    var eventManual= rowEM.Manuals__c;\n    console.log(eventManual);\n    \n    var modelUMA = skuid.model.getModel('UserActionManualNotAgree');\n    console.log(modelUMA.data.length);\n    \n    \n   // var modelUA = skuid.model.getModel('UserActionFormNotFilled');\n    var uMAList=[]; // Array to pupulate User Id List to pass it to Salesforce\n    if (modelUMA)\n    {\n        //var rowsToUpdate = {};    \n        for (var i=0;i&lt;modelUMA.data.length;i++)\n        {\n            \n                //uMAList.push(modelUMA.data[i].User_Manual_Contact__c);\n                if (modelUMA.data[i].Account__c)\n                {\n                    uMAList.push(modelUMA.data[i].Account__c);\n                }\n        }\n       \n    }\n    console.log(uMAList);\n    var JSONString = JSON.stringify(uMAList, null, 2);\n    console.log(JSONString);\n    \n    if (uMAList)\n    {\n        var result = sforce.apex.execute('SingleManualReminderEmail','SingleManualReminderEmail', {eventEditionId:eID,accList:JSONString,EventEditionManual:eventManual},function(result){\n        console.log(result);\n        });\n    }\n    </jsitem><jsitem location=\"external\" name=\"connectionJS\" cachelocation=\"false\" url=\"/soap/ajax/36.0/connection.js\">var params = arguments[0],\n\t$ = skuid.$;\n</jsitem><jsitem location=\"external\" name=\"apexJS\" cachelocation=\"false\" url=\"/soap/ajax/36.0/apex.js\">var params = arguments[0],\n\t$ = skuid.$;\n</jsitem></javascript><css/><actionsequences uniqueid=\"sk-PM5-373\"/></resources><styles><styleitem type=\"background\" bgtype=\"none\"/></styles></skuidpage>","skuid__Layout2__c":null,"skuid__Layout3__c":null,"skuid__Layout4__c":null,"skuid__Layout5__c":null}]